---
ms.date: 07/10/2019
keywords: jea,powershell,sicurezza
title: Considerazioni sulla sicurezza in JEA
ms.openlocfilehash: befc24fec368c4f6d60477daf63bf17e9431133e
ms.sourcegitcommit: 6545c60578f7745be015111052fd7769f8289296
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 04/22/2020
ms.locfileid: "70017772"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="6d78b-103">Considerazioni sulla sicurezza in JEA</span><span class="sxs-lookup"><span data-stu-id="6d78b-103">JEA Security Considerations</span></span>

<span data-ttu-id="6d78b-104">JEA consente di migliorare le condizioni di sicurezza, riducendo il numero di amministratori permanenti nei computer.</span><span class="sxs-lookup"><span data-stu-id="6d78b-104">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="6d78b-105">JEA usa una configurazione di sessione di PowerShell per creare un nuovo punto di ingresso che consente agli utenti di gestire il sistema.</span><span class="sxs-lookup"><span data-stu-id="6d78b-105">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="6d78b-106">Agli utenti che richiedono un livello di accesso al computer elevato ma non illimitato per eseguire attività amministrative è possibile concedere l'accesso all'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-106">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="6d78b-107">Poiché JEA consente di eseguire i comandi di amministratore anche senza avere l'accesso amministratore, è possibile rimuovere questi utenti dai gruppi di sicurezza con privilegi elevati.</span><span class="sxs-lookup"><span data-stu-id="6d78b-107">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="6d78b-108">Account Esegui come</span><span class="sxs-lookup"><span data-stu-id="6d78b-108">Run-As account</span></span>

<span data-ttu-id="6d78b-109">Ogni endpoint JEA ha un account **Esegui come**.</span><span class="sxs-lookup"><span data-stu-id="6d78b-109">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="6d78b-110">Questo è l'account con cui vengono eseguite le azioni dell'utente connesso.</span><span class="sxs-lookup"><span data-stu-id="6d78b-110">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="6d78b-111">Questo account è configurabile nel [file di configurazione sessione](session-configurations.md), e l'account scelto ha un impatto significativo sulla sicurezza dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="6d78b-111">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="6d78b-112">Gli **account virtuali** sono il metodo consigliato per configurare l'account **Esegui come**.</span><span class="sxs-lookup"><span data-stu-id="6d78b-112">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="6d78b-113">Gli account virtuali sono account locali temporanei creati per l'utente che si connette e possono essere usati solo per la durata della sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-113">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="6d78b-114">Al termine della sessione l'account virtuale viene eliminato e non può più essere usato.</span><span class="sxs-lookup"><span data-stu-id="6d78b-114">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="6d78b-115">L'utente che si connette non conosce le credenziali dell'account virtuale.</span><span class="sxs-lookup"><span data-stu-id="6d78b-115">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="6d78b-116">L'account virtuale non può essere usato per accedere al sistema con altri mezzi, come Desktop remoto o un endpoint di PowerShell non vincolato.</span><span class="sxs-lookup"><span data-stu-id="6d78b-116">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="6d78b-117">Per impostazione predefinita gli account virtuali appartengono al gruppo **Administrators** locale del computer.</span><span class="sxs-lookup"><span data-stu-id="6d78b-117">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="6d78b-118">Per questo motivo, hanno diritti completi per gestire qualsiasi elemento nel sistema, ma non possono gestire le risorse della rete.</span><span class="sxs-lookup"><span data-stu-id="6d78b-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="6d78b-119">Durante l'autenticazione con altri computer, il contesto utente è l'account del computer locale, non l'account virtuale.</span><span class="sxs-lookup"><span data-stu-id="6d78b-119">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="6d78b-120">I controller di dominio rappresentano un caso speciale, perché non è presente un gruppo **Administrators**.</span><span class="sxs-lookup"><span data-stu-id="6d78b-120">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="6d78b-121">Gli account virtuali appartengono invece al gruppo **Domain Admins** e possono gestire i servizi directory nel controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="6d78b-121">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="6d78b-122">L'uso dell'identità del dominio resta limitato al controller di dominio in cui è stata creata la sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-122">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="6d78b-123">Qualsiasi accesso alla rete sembra provenire dall'oggetto computer controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="6d78b-123">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="6d78b-124">In entrambi i casi, è possibile definire in modo esplicito a quale gruppo di sicurezza appartiene l'account virtuale.</span><span class="sxs-lookup"><span data-stu-id="6d78b-124">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="6d78b-125">Questa è una procedura efficace se l'attività può essere eseguita senza privilegi di amministratore locale o di dominio.</span><span class="sxs-lookup"><span data-stu-id="6d78b-125">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="6d78b-126">Se è già disponibile un gruppo di sicurezza definito per gli amministratori, concedere all'account virtuale l'appartenenza a tale gruppo.</span><span class="sxs-lookup"><span data-stu-id="6d78b-126">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="6d78b-127">L'appartenenza a gruppi dell'account virtuale è limitato ai gruppi di sicurezza locali nella workstation e nei server membri.</span><span class="sxs-lookup"><span data-stu-id="6d78b-127">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="6d78b-128">Nei controller di dominio gli account virtuali devono essere membri di gruppi di sicurezza del dominio.</span><span class="sxs-lookup"><span data-stu-id="6d78b-128">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="6d78b-129">Dopo che l'account virtuale è stato aggiunto a uno o più gruppi di sicurezza, non appartiene più ai gruppi predefiniti (amministratore locale o di dominio).</span><span class="sxs-lookup"><span data-stu-id="6d78b-129">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="6d78b-130">La tabella seguente illustra le opzioni di configurazione possibili e le autorizzazioni risultanti per gli account virtuali:</span><span class="sxs-lookup"><span data-stu-id="6d78b-130">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="6d78b-131">Tipo di computer</span><span class="sxs-lookup"><span data-stu-id="6d78b-131">Computer type</span></span>         | <span data-ttu-id="6d78b-132">Configurazione del gruppo di account virtuali</span><span class="sxs-lookup"><span data-stu-id="6d78b-132">Virtual account group configuration</span></span> |                   <span data-ttu-id="6d78b-133">Contesto dell'utente locale</span><span class="sxs-lookup"><span data-stu-id="6d78b-133">Local user context</span></span>                    | <span data-ttu-id="6d78b-134">Contesto dell'utente di rete</span><span class="sxs-lookup"><span data-stu-id="6d78b-134">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="6d78b-135">Controller di dominio</span><span class="sxs-lookup"><span data-stu-id="6d78b-135">Domain controller</span></span>            | <span data-ttu-id="6d78b-136">Predefinito</span><span class="sxs-lookup"><span data-stu-id="6d78b-136">Default</span></span>                             | <span data-ttu-id="6d78b-137">Utente di dominio, membro di "*DOMAIN*\Domain Admins"</span><span class="sxs-lookup"><span data-stu-id="6d78b-137">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="6d78b-138">Account del computer</span><span class="sxs-lookup"><span data-stu-id="6d78b-138">Computer account</span></span>     |
| <span data-ttu-id="6d78b-139">Controller di dominio</span><span class="sxs-lookup"><span data-stu-id="6d78b-139">Domain controller</span></span>            | <span data-ttu-id="6d78b-140">Gruppi di dominio A e B</span><span class="sxs-lookup"><span data-stu-id="6d78b-140">Domain groups A and B</span></span>               | <span data-ttu-id="6d78b-141">Utente di dominio, membro di "*DOMAIN*\A", "*DOMAIN*\B"</span><span class="sxs-lookup"><span data-stu-id="6d78b-141">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="6d78b-142">Account del computer</span><span class="sxs-lookup"><span data-stu-id="6d78b-142">Computer account</span></span>     |
| <span data-ttu-id="6d78b-143">Workstation o server membro</span><span class="sxs-lookup"><span data-stu-id="6d78b-143">Member server or workstation</span></span> | <span data-ttu-id="6d78b-144">Predefinito</span><span class="sxs-lookup"><span data-stu-id="6d78b-144">Default</span></span>                             | <span data-ttu-id="6d78b-145">Utente locale, membro di "*BUILTIN*\Administrators"</span><span class="sxs-lookup"><span data-stu-id="6d78b-145">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="6d78b-146">Account del computer</span><span class="sxs-lookup"><span data-stu-id="6d78b-146">Computer account</span></span>     |
| <span data-ttu-id="6d78b-147">Workstation o server membro</span><span class="sxs-lookup"><span data-stu-id="6d78b-147">Member server or workstation</span></span> | <span data-ttu-id="6d78b-148">Gruppi locali C e D</span><span class="sxs-lookup"><span data-stu-id="6d78b-148">Local groups C and D</span></span>                | <span data-ttu-id="6d78b-149">Utente locale, membro di "*COMPUTER*\C" e "*COMPUTER*\D"</span><span class="sxs-lookup"><span data-stu-id="6d78b-149">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="6d78b-150">Account del computer</span><span class="sxs-lookup"><span data-stu-id="6d78b-150">Computer account</span></span>     |

<span data-ttu-id="6d78b-151">Quando si esaminano gli eventi del controllo di sicurezza e i log eventi dell'applicazione, si noterà che ogni sessione utente JEA ha un account virtuale univoco.</span><span class="sxs-lookup"><span data-stu-id="6d78b-151">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="6d78b-152">Questo account univoco consente di far risalire le azioni dell'utente in un endpoint JEA all'utente originale che ha eseguito il comando.</span><span class="sxs-lookup"><span data-stu-id="6d78b-152">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="6d78b-153">I nomi degli account virtuali hanno il formato `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>`. Se ad esempio l'utente **Alice** del dominio **Contoso** riavvia un servizio in un endpoint JEA, il nome utente associato a eventi di gestione del controllo del servizio sarà `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span><span class="sxs-lookup"><span data-stu-id="6d78b-153">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="6d78b-154">Gli **account del servizio gestito del gruppo (gMSA)** sono utili quando un server membro deve accedere alle risorse di rete nella sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-154">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="6d78b-155">Un esempio è il caso in cui l'endpoint JEA viene usato per controllare l'accesso a un'API REST ospitata in un altro computer.</span><span class="sxs-lookup"><span data-stu-id="6d78b-155">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="6d78b-156">È facile scrivere funzioni per chiamare le API REST, ma per l'autenticazione nell'API è necessaria un'identità di rete.</span><span class="sxs-lookup"><span data-stu-id="6d78b-156">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="6d78b-157">L'uso di un account del servizio gestito del gruppo rende possibile il secondo hop, consentendo di mantenere il controllo sui computer che possono usare l'account.</span><span class="sxs-lookup"><span data-stu-id="6d78b-157">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="6d78b-158">Le autorizzazioni valide dei gMSA sono definite dai gruppi di sicurezza (locale o di dominio) a cui appartiene l'account gMSA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-158">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="6d78b-159">Quando un endpoint JEA è configurato per usare un account gMSA, le azioni di tutti gli utenti JEA vengono registrate come se provenissero dallo stesso account del servizio gestito.</span><span class="sxs-lookup"><span data-stu-id="6d78b-159">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="6d78b-160">L'unico modo per far risalire determinate azioni a un utente specifico è l'identificazione del set di comandi eseguiti in una trascrizione della sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6d78b-160">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="6d78b-161">Le **credenziali pass-through** vengono usate quando non si specifica un account **Esegui come**.</span><span class="sxs-lookup"><span data-stu-id="6d78b-161">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="6d78b-162">PowerShell usa le credenziali dell'utente connesso per eseguire comandi nel server remoto.</span><span class="sxs-lookup"><span data-stu-id="6d78b-162">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="6d78b-163">Pertanto è necessario concedere all'utente connesso l'accesso diretto ai gruppi di gestione con privilegi.</span><span class="sxs-lookup"><span data-stu-id="6d78b-163">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="6d78b-164">Questa configurazione **non** è consigliata per JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-164">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="6d78b-165">Se l'utente che si connette ha già privilegi di amministratore, può evitare del tutto JEA e gestire il sistema con altri mezzi non vincolati.</span><span class="sxs-lookup"><span data-stu-id="6d78b-165">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="6d78b-166">Per altre informazioni, vedere nella sezione seguente come [JEA non offre protezione dagli amministratori](#jea-doesnt-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="6d78b-166">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="6d78b-167">Gli **account Esegui come standard** consentono di specificare qualsiasi account utente in cui verrà eseguita l'intera sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6d78b-167">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="6d78b-168">Le configurazioni di sessione che usano account **Esegui come** fissi (con il parametro `-RunAsCredential`) non supportano JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-168">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="6d78b-169">Le definizioni del ruolo smettono di funzionare come previsto.</span><span class="sxs-lookup"><span data-stu-id="6d78b-169">Role definitions no longer function as expected.</span></span> <span data-ttu-id="6d78b-170">Viene assegnato lo stesso ruolo a tutti gli utenti autorizzati ad accedere all'endpoint.</span><span class="sxs-lookup"><span data-stu-id="6d78b-170">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="6d78b-171">È consigliabile non usare **RunAsCredential** su un endpoint JEA perché rende difficile attribuire azioni a utenti specifici e per la mancanza di supporto per il mapping degli utenti ai ruoli.</span><span class="sxs-lookup"><span data-stu-id="6d78b-171">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="6d78b-172">ACL endpoint di WinRM</span><span class="sxs-lookup"><span data-stu-id="6d78b-172">WinRM Endpoint ACL</span></span>

<span data-ttu-id="6d78b-173">Come per i normali endpoint di comunicazione remota di PowerShell, ogni endpoint JEA ha un elenco di controllo di accesso (ACL) separato che controlla gli utenti che possono eseguire l'autenticazione con l'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-173">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="6d78b-174">Se la configurazione non è corretta, gli utenti attendibili potrebbero non essere in grado di accedere all'endpoint JEA e/o gli utenti non attendibili potrebbero invece ottenere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="6d78b-174">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="6d78b-175">L'ACL WinRM non influisce sul mapping degli utenti ai ruoli JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-175">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="6d78b-176">Questo mapping è controllato dal campo **RoleDefinitions** nel file di configurazione sessione usato per registrare l'endpoint.</span><span class="sxs-lookup"><span data-stu-id="6d78b-176">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="6d78b-177">Per impostazione predefinita, quando un endpoint JEA ha più funzionalità di ruolo, l'elenco di controllo di accesso WinRM è configurato per consentire l'accesso a tutti gli utenti con mapping.</span><span class="sxs-lookup"><span data-stu-id="6d78b-177">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="6d78b-178">Ad esempio, una sessione JEA configurata usando i comandi seguenti concede l'accesso completo a `CONTOSO\JEA_Lev1` e `CONTOSO\JEA_Lev2`.</span><span class="sxs-lookup"><span data-stu-id="6d78b-178">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="6d78b-179">È possibile controllare le autorizzazioni utente con il cmdlet [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration).</span><span class="sxs-lookup"><span data-stu-id="6d78b-179">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="6d78b-180">Per modificare l'accesso degli utenti, eseguire `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` per un prompt interattivo o `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` per aggiornare le autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="6d78b-180">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="6d78b-181">Gli utenti devono avere almeno i diritti di *chiamata* per accedere all'endpoint JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-181">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="6d78b-182">È possibile creare un endpoint JEA che non esegue il mapping di un ruolo definito a ogni utente che esegue l'accesso.</span><span class="sxs-lookup"><span data-stu-id="6d78b-182">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="6d78b-183">Questi utenti possono avviare una sessione JEA, ma dispongono solo dell'accesso ai cmdlet predefiniti.</span><span class="sxs-lookup"><span data-stu-id="6d78b-183">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="6d78b-184">È possibile controllare le autorizzazioni degli utenti in un endpoint JEA eseguendo `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="6d78b-184">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="6d78b-185">Per altre informazioni, vedere [Controllo e creazione di report in JEA](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="6d78b-185">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="6d78b-186">Ruoli con privilegi minimi</span><span class="sxs-lookup"><span data-stu-id="6d78b-186">Least privilege roles</span></span>

<span data-ttu-id="6d78b-187">Quando si progettano ruoli JEA è importante ricordare che gli account virtuale e del servizio gestito del gruppo eseguiti in background possono avere accesso illimitato alla gestione del computer locale.</span><span class="sxs-lookup"><span data-stu-id="6d78b-187">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="6d78b-188">Le funzionalità di ruolo JEA consentono di limitare i comandi e le applicazioni eseguibili in tale contesto con privilegi.</span><span class="sxs-lookup"><span data-stu-id="6d78b-188">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="6d78b-189">I ruoli progettati in modo non corretto possono consentire l'esecuzione di comandi pericolosi, che potrebbero permettere a un utente di oltrepassare i limiti JEA o di ottenere l'accesso a informazioni riservate.</span><span class="sxs-lookup"><span data-stu-id="6d78b-189">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="6d78b-190">Ad esempio, prendere in considerazione la voce relativa alla funzionalità di ruolo seguente:</span><span class="sxs-lookup"><span data-stu-id="6d78b-190">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="6d78b-191">Questa funzionalità di ruolo consente agli utenti di eseguire qualsiasi cmdlet di PowerShell con il termine **Process** dal modulo **Microsoft.PowerShell.Management**.</span><span class="sxs-lookup"><span data-stu-id="6d78b-191">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="6d78b-192">Gli utenti possono avere l'esigenza di accedere a cmdlet specifici, ad esempio `Get-Process` per identificare le applicazioni in esecuzione nel sistema e `Stop-Process` per terminare le applicazioni che non rispondono.</span><span class="sxs-lookup"><span data-stu-id="6d78b-192">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="6d78b-193">Questa voce consente anche il cmdlet `Start-Process`, che può essere usato per avviare un programma arbitrario con autorizzazioni complete di amministratore.</span><span class="sxs-lookup"><span data-stu-id="6d78b-193">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="6d78b-194">Non è necessario che il programma sia installato localmente nel sistema.</span><span class="sxs-lookup"><span data-stu-id="6d78b-194">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="6d78b-195">Un utente connesso può avviare da una condivisione di file un programma che garantisce privilegi di amministratore locale, esegue malware e altro ancora.</span><span class="sxs-lookup"><span data-stu-id="6d78b-195">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="6d78b-196">Di seguito viene illustrata una versione più sicura della stessa funzionalità di ruolo:</span><span class="sxs-lookup"><span data-stu-id="6d78b-196">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="6d78b-197">Evitare di usare i caratteri jolly nelle funzionalità di ruolo.</span><span class="sxs-lookup"><span data-stu-id="6d78b-197">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="6d78b-198">Assicurarsi di [controllare le autorizzazioni utente effettive](audit-and-report.md#check-effective-rights-for-a-specific-user) con cadenza periodica, per determinare quali comandi sono accessibili all'utente.</span><span class="sxs-lookup"><span data-stu-id="6d78b-198">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="6d78b-199">JEA non offre protezione dagli amministratori</span><span class="sxs-lookup"><span data-stu-id="6d78b-199">JEA doesn't protect against admins</span></span>

<span data-ttu-id="6d78b-200">Uno dei principi fondamentali di JEA è che consente a utenti non amministratori di eseguire alcune attività di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="6d78b-200">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="6d78b-201">JEA non offre protezione dagli utenti che hanno già privilegi di amministratore.</span><span class="sxs-lookup"><span data-stu-id="6d78b-201">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="6d78b-202">Gli utenti che appartengono a **Domain Admins**, al gruppo **Administrators** locale o ad altri gruppi con privilegi elevati possono aggirare le protezioni di JEA con altri mezzi.</span><span class="sxs-lookup"><span data-stu-id="6d78b-202">Users who belong **Domain Admins**, local **Administrators**, or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="6d78b-203">Ad esempio un utente può accedere con RDP, usare console MMC remote o connettersi agli endpoint di PowerShell non vincolati.</span><span class="sxs-lookup"><span data-stu-id="6d78b-203">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="6d78b-204">Gli amministratori locali del sistema possono anche modificare le configurazioni JEA per consentire l'accesso ad altri utenti o modificare una funzionalità di ruolo per estendere l'ambito delle operazioni eseguibili da un utente nella sessione JEA.</span><span class="sxs-lookup"><span data-stu-id="6d78b-204">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="6d78b-205">È importante valutare le autorizzazioni estese degli utenti JEA, per verificare se esistono altri modi per ottenere l'accesso con privilegi al sistema.</span><span class="sxs-lookup"><span data-stu-id="6d78b-205">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="6d78b-206">Una pratica comune è usare JEA per una regolare manutenzione quotidiana e avere una soluzione di gestione dell'accesso just-in-time con privilegi, che consente agli utenti di diventare temporaneamente amministratori locali in situazioni di emergenza.</span><span class="sxs-lookup"><span data-stu-id="6d78b-206">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="6d78b-207">In questo modo gli utenti non sono amministratori permanenti del sistema, ma possono ottenere tali diritti se e solo se portano a termine un flusso di lavoro che documenta l'uso di tali autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="6d78b-207">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
