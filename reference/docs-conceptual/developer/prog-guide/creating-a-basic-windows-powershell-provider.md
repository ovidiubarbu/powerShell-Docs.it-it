---
title: Creazione di un provider di base di Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: 0f8621cd22ca402f3a564ccdfb36c97da68dac6a
ms.sourcegitcommit: 7f2479edd329dfdc55726afff7019d45e45f9156
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/08/2020
ms.locfileid: "80978509"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="95b45-102">Creazione di un provider di Windows PowerShell di base</span><span class="sxs-lookup"><span data-stu-id="95b45-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="95b45-103">Questo argomento è il punto di partenza per apprendere come creare un provider di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="95b45-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="95b45-104">Il provider di base descritto di seguito fornisce i metodi per l'avvio e l'arresto del provider, sebbene questo provider non fornisca un mezzo per accedere a un archivio dati o per ottenere o impostare i dati nell'archivio dati, fornisce le funzionalità di base richieste da tutti i provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="95b45-105">Come indicato in precedenza, il provider di base descritto di seguito implementa i metodi per l'avvio e l'arresto del provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="95b45-106">Il runtime di Windows PowerShell chiama questi metodi per inizializzare e annullare l'inizializzazione del provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="95b45-107">È possibile trovare un esempio di questo provider nel file AccessDBSampleProvider01.cs fornito da Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="95b45-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="95b45-108">Definizione della classe del provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b45-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="95b45-109">Il primo passaggio nella creazione di un provider di Windows PowerShell consiste nel definirne la classe .NET.</span><span class="sxs-lookup"><span data-stu-id="95b45-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="95b45-110">Questo provider di base definisce una classe denominata `AccessDBProvider` che deriva dalla classe di base [System. Management. Automation. provider. CmdletProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="95b45-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="95b45-111">È consigliabile inserire le classi del provider in uno spazio dei nomi `Providers` dello spazio dei nomi dell'API, ad esempio, xxx. PowerShell. Providers.</span><span class="sxs-lookup"><span data-stu-id="95b45-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="95b45-112">Questo provider usa lo spazio dei nomi `Microsoft.Samples.PowerShell.Provider`, in cui vengono eseguiti tutti gli esempi del provider di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="95b45-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="95b45-113">La classe per un provider di Windows PowerShell deve essere contrassegnata in modo esplicito come Public.</span><span class="sxs-lookup"><span data-stu-id="95b45-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="95b45-114">Per impostazione predefinita, le classi non contrassegnate come pubbliche saranno interne e non verranno trovate dal runtime di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="95b45-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="95b45-115">Di seguito è illustrata la definizione della classe per il provider Basic:</span><span class="sxs-lookup"><span data-stu-id="95b45-115">Here is the class definition for this basic provider:</span></span>

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs" range="23-24":::

<span data-ttu-id="95b45-116">Immediatamente prima della definizione della classe, è necessario dichiarare l'attributo [System. Management. Automation. provider. CmdletProviderAttribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) , con la sintassi [CmdletProvider ()].</span><span class="sxs-lookup"><span data-stu-id="95b45-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="95b45-117">È possibile impostare le parole chiave degli attributi per dichiarare ulteriormente la classe se necessario.</span><span class="sxs-lookup"><span data-stu-id="95b45-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="95b45-118">Si noti che l'attributo [System. Management. Automation. provider. CmdletProviderAttribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) dichiarato qui include due parametri.</span><span class="sxs-lookup"><span data-stu-id="95b45-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="95b45-119">Il primo parametro attribute specifica il nome descrittivo predefinito per il provider, che può essere modificato successivamente dall'utente.</span><span class="sxs-lookup"><span data-stu-id="95b45-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="95b45-120">Il secondo parametro specifica le funzionalità definite da Windows PowerShell che il provider espone al runtime di Windows PowerShell durante l'elaborazione del comando.</span><span class="sxs-lookup"><span data-stu-id="95b45-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="95b45-121">I valori possibili per le funzionalità del provider sono definiti dall'enumerazione [System. Management. Automation. provider. ProviderCapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="95b45-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="95b45-122">Poiché si tratta di un provider di base, non supporta alcuna funzionalità.</span><span class="sxs-lookup"><span data-stu-id="95b45-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="95b45-123">Il nome completo del provider di Windows PowerShell include il nome dell'assembly e altri attributi determinati da Windows PowerShell al momento della registrazione del provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="95b45-124">Definizione delle informazioni sullo stato specifiche del provider</span><span class="sxs-lookup"><span data-stu-id="95b45-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="95b45-125">La classe di base [System. Management. Automation. provider. CmdletProvider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) e tutte le classi derivate sono considerate senza stato perché il runtime di Windows PowerShell crea le istanze del provider solo se necessario.</span><span class="sxs-lookup"><span data-stu-id="95b45-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="95b45-126">Pertanto, se il provider richiede il controllo completo e la manutenzione dello stato per i dati specifici del provider, deve derivare una classe dalla classe [System. Management. Automation. ProviderInfo restituito da](/dotnet/api/System.Management.Automation.ProviderInfo) .</span><span class="sxs-lookup"><span data-stu-id="95b45-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="95b45-127">La classe derivata deve definire i membri necessari per mantenere lo stato in modo che sia possibile accedere ai dati specifici del provider quando il runtime di Windows PowerShell chiama il metodo [System. Management. Automation. provider. CmdletProvider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) per inizializzare il provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="95b45-128">Un provider di Windows PowerShell è inoltre in grado di mantenere lo stato basato sulla connessione.</span><span class="sxs-lookup"><span data-stu-id="95b45-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="95b45-129">Per ulteriori informazioni sulla gestione dello stato della connessione, vedere la pagina relativa alla [creazione di un provider di unità PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="95b45-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="95b45-130">Inizializzazione del provider</span><span class="sxs-lookup"><span data-stu-id="95b45-130">Initializing the Provider</span></span>

<span data-ttu-id="95b45-131">Per inizializzare il provider, il runtime di Windows PowerShell chiama il metodo [System. Management. Automation. provider. CmdletProvider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) all'avvio di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="95b45-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="95b45-132">Nella maggior parte dei casi, il provider può usare l'implementazione predefinita di questo metodo, che restituisce semplicemente l'oggetto [System. Management. Automation. ProviderInfo restituito da](/dotnet/api/System.Management.Automation.ProviderInfo) che descrive il provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="95b45-133">Tuttavia, nel caso in cui si desideri aggiungere ulteriori informazioni di inizializzazione, è necessario implementare il metodo [System. Management. Automation. provider. CmdletProvider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) che restituisce una versione modificata dell'oggetto [System. Management. Automation. ProviderInfo restituito da](/dotnet/api/System.Management.Automation.ProviderInfo) passato al provider.</span><span class="sxs-lookup"><span data-stu-id="95b45-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="95b45-134">In generale, questo metodo deve restituire l'oggetto [System. Management. Automation. ProviderInfo restituito da](/dotnet/api/System.Management.Automation.ProviderInfo) fornito o un oggetto [System. Management. Automation. ProviderInfo restituito da](/dotnet/api/System.Management.Automation.ProviderInfo) modificato che contiene altre informazioni di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="95b45-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="95b45-135">Questo provider di base non esegue l'override di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="95b45-135">This basic provider does not override this method.</span></span> <span data-ttu-id="95b45-136">Tuttavia, nel codice seguente viene illustrata l'implementazione predefinita di questo metodo:</span><span class="sxs-lookup"><span data-stu-id="95b45-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="95b45-137">Il provider può mantenere lo stato delle informazioni specifiche del provider, come descritto in [definizione dello stato dei dati specifico del provider](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="95b45-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="95b45-138">In questo caso, l'implementazione deve eseguire l'override del metodo [System. Management. Automation. provider. CmdletProvider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) per restituire un'istanza della classe derivata.</span><span class="sxs-lookup"><span data-stu-id="95b45-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="95b45-139">Avvia parametri dinamici</span><span class="sxs-lookup"><span data-stu-id="95b45-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="95b45-140">L'implementazione del provider del metodo [System. Management. Automation. provider. CmdletProvider. Start \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) potrebbe richiedere parametri aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="95b45-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="95b45-141">In questo caso, il provider deve eseguire l'override del metodo [System. Management. Automation. provider. CmdletProvider. Startdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) e restituire un oggetto con proprietà e campi con attributi di analisi simili a una classe di cmdlet o a un oggetto [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="95b45-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="95b45-142">Questo provider di base non esegue l'override di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="95b45-142">This basic provider does not override this method.</span></span> <span data-ttu-id="95b45-143">Tuttavia, nel codice seguente viene illustrata l'implementazione predefinita di questo metodo:</span><span class="sxs-lookup"><span data-stu-id="95b45-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="95b45-144">Annullamento dell'inizializzazione del provider</span><span class="sxs-lookup"><span data-stu-id="95b45-144">Uninitializing the Provider</span></span>

<span data-ttu-id="95b45-145">Per liberare le risorse utilizzate dal provider di Windows PowerShell, il provider deve implementare il proprio metodo [System. Management. Automation. provider. CmdletProvider. Stop \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) .</span><span class="sxs-lookup"><span data-stu-id="95b45-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="95b45-146">Questo metodo viene chiamato dal runtime di Windows PowerShell per annullare l'inizializzazione del provider alla chiusura di una sessione.</span><span class="sxs-lookup"><span data-stu-id="95b45-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="95b45-147">Questo provider di base non esegue l'override di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="95b45-147">This basic provider does not override this method.</span></span> <span data-ttu-id="95b45-148">Tuttavia, nel codice seguente viene illustrata l'implementazione predefinita di questo metodo:</span><span class="sxs-lookup"><span data-stu-id="95b45-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="95b45-149">Codice di esempio</span><span class="sxs-lookup"><span data-stu-id="95b45-149">Code Sample</span></span>

<span data-ttu-id="95b45-150">Per il codice di esempio completo, vedere [esempio di codice AccessDbProviderSample01](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="95b45-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="95b45-151">Test del provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b45-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="95b45-152">Dopo aver registrato il provider di Windows PowerShell con Windows PowerShell, è possibile testarlo eseguendo i cmdlet supportati nella riga di comando.</span><span class="sxs-lookup"><span data-stu-id="95b45-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="95b45-153">Per questo provider di base, eseguire la nuova shell e utilizzare il cmdlet `Get-PSProvider` per recuperare l'elenco di provider e verificare che sia presente il provider AccessDb.</span><span class="sxs-lookup"><span data-stu-id="95b45-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="95b45-154">Viene visualizzato l'output seguente:</span><span class="sxs-lookup"><span data-stu-id="95b45-154">The following output appears:</span></span>

```Output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="95b45-155">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="95b45-155">See Also</span></span>

[<span data-ttu-id="95b45-156">Creazione di provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b45-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="95b45-157">Progettazione del provider di Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b45-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)
